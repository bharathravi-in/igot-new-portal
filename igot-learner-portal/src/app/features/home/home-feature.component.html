<ds-page-container>
  <div class="home-feature">

    <!-- Hero Banner -->
    <section class="hero-banner">
      <div class="hero-content">
        <h1 class="hero-title">{{ bannerTitle }}</h1>
        <p class="hero-subtitle">{{ bannerSubtitle }}</p>
        <button mat-flat-button color="primary" class="hero-cta">
          <mat-icon>play_circle</mat-icon>
          Start Learning
        </button>
      </div>
    </section>

    <!-- User Profile Card -->
    <ds-section-container>
      <h2 class="section-title">My Profile</h2>

      <!-- Loading State -->
      <div *ngIf="userLoading()" class="user-loading">
        <mat-spinner diameter="40"></mat-spinner>
        <span>Loading profile...</span>
      </div>

      <!-- Error State -->
      <div *ngIf="!userLoading() && userError()" class="user-error">
        <mat-icon color="warn">error_outline</mat-icon>
        <span>Could not load profile. Please check your session.</span>
      </div>

      <!-- User Data Card -->
      <mat-card *ngIf="!userLoading() && user() as u" class="user-profile-card" appearance="outlined">
        <mat-card-header>
          <div mat-card-avatar class="user-avatar">
            <mat-icon>account_circle</mat-icon>
          </div>
          <mat-card-title>{{ u.firstName }}</mat-card-title>
          <mat-card-subtitle>{{ u.channel }}</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content>
          <mat-divider></mat-divider>
          <div class="user-info-grid">

            <!-- Department -->
            <div class="user-info-row" *ngIf="u.profileDetails?.employmentDetails?.departmentName">
              <mat-icon class="info-icon">business</mat-icon>
              <div>
                <span class="info-label">Department</span>
                <span class="info-value">{{ u.profileDetails!.employmentDetails!.departmentName }}</span>
              </div>
            </div>

            <!-- Civil Service -->
            <div class="user-info-row" *ngIf="u.profileDetails?.cadreDetails?.civilServiceName">
              <mat-icon class="info-icon">gavel</mat-icon>
              <div>
                <span class="info-label">Civil Service</span>
                <span class="info-value">{{ u.profileDetails!.cadreDetails!.civilServiceName }}</span>
              </div>
            </div>

            <!-- Cadre -->
            <div class="user-info-row" *ngIf="u.profileDetails?.cadreDetails?.cadreName">
              <mat-icon class="info-icon">location_on</mat-icon>
              <div>
                <span class="info-label">Cadre</span>
                <span class="info-value">
                  {{ u.profileDetails!.cadreDetails!.cadreName }}
                  (Batch {{ u.profileDetails!.cadreDetails!.cadreBatch }})
                </span>
              </div>
            </div>

            <!-- Designation Status -->
            <div class="user-info-row" *ngIf="u.profileDetails?.profileDesignationStatus">
              <mat-icon class="info-icon">verified</mat-icon>
              <div>
                <span class="info-label">Designation Status</span>
                <mat-chip [color]="u.profileDetails!.profileDesignationStatus === 'VERIFIED' ? 'primary' : 'warn'" selected>
                  {{ u.profileDetails!.profileDesignationStatus }}
                </mat-chip>
              </div>
            </div>

            <!-- Phone -->
            <div class="user-info-row" *ngIf="u.maskedPhone">
              <mat-icon class="info-icon">phone</mat-icon>
              <div>
                <span class="info-label">Phone</span>
                <span class="info-value">{{ u.maskedPhone }}</span>
              </div>
            </div>

            <!-- User ID -->
            <div class="user-info-row">
              <mat-icon class="info-icon">badge</mat-icon>
              <div>
                <span class="info-label">User ID</span>
                <span class="info-value user-id">{{ u.identifier }}</span>
              </div>
            </div>

          </div>

          <!-- Profile Completion -->
          <div class="profile-completion" *ngIf="u.profileUpdateCompletion != null">
            <div class="completion-header">
              <mat-icon>insights</mat-icon>
              <span>Profile Completion</span>
              <strong>{{ u.profileUpdateCompletion }}%</strong>
            </div>
            <mat-progress-bar
              mode="determinate"
              [value]="u.profileUpdateCompletion"
              [color]="u.profileUpdateCompletion >= 80 ? 'primary' : 'warn'">
            </mat-progress-bar>
          </div>
        </mat-card-content>

        <mat-card-actions align="end">
          <button mat-button color="primary" (click)="navigateQuickLink('/profile')">
            <mat-icon>edit</mat-icon> Edit Profile
          </button>
        </mat-card-actions>
      </mat-card>
    </ds-section-container>

    <!-- Quick Links -->
    <ds-section-container>
      <div class="quick-links-grid">
        <mat-card *ngFor="let link of quickLinks" class="quick-link-card" appearance="outlined"
          style="cursor:pointer" (click)="navigateQuickLink(link.route)">
          <mat-card-content>
            <mat-icon class="quick-link-icon" color="primary">{{ link.icon }}</mat-icon>
            <span class="quick-link-label">{{ link.label }}</span>
          </mat-card-content>
        </mat-card>
      </div>
    </ds-section-container>

    <!-- Featured Courses -->
    <ds-section-container>
      <h2 class="section-title">Featured Courses</h2>
      <ds-responsive-grid>
        <mat-card *ngFor="let course of featuredCourses" class="course-card" appearance="outlined">
          <mat-card-header>
            <mat-icon mat-card-avatar class="course-icon">{{ course.icon }}</mat-icon>
            <mat-card-title>{{ course.title }}</mat-card-title>
            <mat-card-subtitle>
              <mat-chip-set>
                <mat-chip>{{ course.category }}</mat-chip>
                <mat-chip>{{ course.level }}</mat-chip>
              </mat-chip-set>
            </mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <p>{{ course.description }}</p>
            <span class="course-duration">
              <mat-icon inline>schedule</mat-icon> {{ course.duration }}
            </span>
          </mat-card-content>
          <mat-card-actions align="end">
            <button mat-button color="primary" (click)="enrollInCourse(course.courseId)">Enroll Now</button>
          </mat-card-actions>
        </mat-card>
      </ds-responsive-grid>
    </ds-section-container>

    <div class="mfe-badge">
      <mat-icon>extension</mat-icon>
      <span>Angular 20 MFE â€” Home Feature</span>
    </div>
  </div>
</ds-page-container>
